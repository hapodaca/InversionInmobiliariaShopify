{% comment %}theme-check-disable ImgLazyLoading, RemoteAsset{% endcomment %}
{%- liquid
  assign current_active_values_count = false
  for filter in results.filters
  if filter.active_values.size > 0
  assign current_active_values_count =  true
  break
  endif
  if filter.type == "price_range"
  if filter.min_value.value > 0 or filter.max_value.value < filter.range_max
  assign current_active_values_count =  true
  endif
  endif
  endfor
  if results.url
  assign results_url = results.url
  else
  assign terms = results.terms | escape
  assign results_url = '?q=' | append: terms | append: '&options%5Bprefix%5D=last&sort_by=' | append: sort_by
  endif

  assign color_options_name = settings.product_card_color_options_name | split: ","
-%}
{%- if current_active_values_count -%}
  <div class="filter-row-selected">
    <div class="row gy-2 flex-wrap">
      <div class="col-12 col-sm-auto">
        <ul class="tags-list">

          {%- for filter in results.filters -%}
            {%- for value in filter.active_values -%}
              {%- liquid
                assign data_ajax = filter.url_to_remove
                unless data_ajax contains "?"
                  assign data_ajax = data_ajax | append: '?'
                endunless

                assign data_ajax = data_ajax | append: '&section_id=async-facets'
              -%}
              <facet-remove data-ajax="{{ data_ajax }}">
                <li>
                  <a href="{{ value.url_to_remove }}" data-control="Filter-{{ filter.param_name | handle | escape }}-{{ forloop.index }}"><span class="tags-list-close"></span>
                    <span>{{ filter.label }}:</span>
                    <span>
                      {%- if show_sizes and size_options_name == filter.label -%}
                        {{ value.label | escape }}
                      {%- else -%}
                        {{ value.label | escape }}
                      {%- endif -%}
                    </span>
                    <span class="visually-hidden">{{ 'general.clear_filters' | t }}</span>
                    {%- if show_colorpics and color_options_name contains filter.label -%}
                      {%- liquid
                        assign absent = false
                        assign color_image_preffix = 'pill-pic-' | append: filter.label | handle | append: '-'
                        assign color_pic_url =  color_image_preffix | append: value.label | handle | append: '.png' | file_img_url: width: '48', height: '48'
                        assign color_pic_url_size = color_pic_url | split: '?' | last | size
                        if color_pic_url_size <= 6
                        assign absent = true
                        endif
                      -%}
                      {%- unless absent -%}
                        <span class="tags-list-color"><img src="{{ color_pic_url }}" alt="{{ value.label | escape }}" width="24" height="24"></span>
                      {%- endunless -%}
                    {%- endif -%}
                  </a>
                </li>
              </facet-remove>
            {%- endfor -%}
            {% if filter.type == "price_range" %}
              {%- if filter.min_value.value != nil or filter.max_value.value != nil -%}
                {%- if filter.min_value.value > 0 or filter.max_value.value < filter.range_max -%}
                  <facet-remove>
                    <li><a href="{{ filter.url_to_remove }}"><span class="tags-list-close"></span><span>{{ filter.label }}: {% if filter.min_value.value -%}{{ filter.min_value.value | money }}{%- else -%}{{ 0 | money }}{%- endif -%}-{%- if filter.max_value.value -%}{{ filter.max_value.value | money }}{%- else -%}{{ filter.range_max | money }}{%- endif -%}<span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span></span></a></li>
                  </facet-remove>
                {%- endif -%}
              {%- endif -%}
            {% endif %}
          {%- endfor -%}
        </ul>
      </div>
      <div class="col-6 col-sm-auto ms-auto">
        {%- liquid
          assign data_ajax = filter_vendor.url_to_remove
          unless data_ajax contains "?"
            assign data_ajax = data_ajax | append: '?'
          endunless

          assign data_ajax = data_ajax | append: '&section_id=async-facets'
        -%}
        <facet-remove data-ajax="{{ data_ajax }}" data-filter-load-force="true">
          <a href="{{ results_url }}" class="clear-filters"><span class="icon-wrap">{% render 'icon-remove2' %}</span><span>{{ 'general.clear_filters' | t }}</span></a>
        </facet-remove>
      </div>
      <div class="col-6 d-sm-none">
        <div class="filter-row-info text-end">
          {%- if request.page_type == 'search' -%}
            {%- if search.results_count > 0 -%}
              <span role="status">{{ 'templates.search.results_with_count_and_term' | t: terms: search.terms, count: search.results_count }}</span>
            {%- endif -%}
          {%- else -%}
            {%- if results.results_count -%}
              {{ 'templates.search.results_with_count' | t: terms: results.terms, count: results.results_count }}
              {%- elsif results.products_count == results.all_products_count -%}
              {{ 'products.facets.product_count_simple' | t: count: results.products_count }}
            {%- else -%}
              {{ 'products.facets.product_count' | t: product_count: results.products_count, count: results.all_products_count }}
            {%- endif -%}
          {%- endif -%}

        </div>
      </div>
    </div>
  </div>
{%- endif -%}